
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hesseflux.functions.sa_test_functions &#8212; hesseflux 3.2.2.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for hesseflux.functions.sa_test_functions</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module provides test functions for parameter sensitivity analysis from</span>
<span class="sd">    Ishigami and Homma (1990) An importance qualification technique in uncertainty analysis for computer models,</span>
<span class="sd">                              Proceedings of the isuma &#39;90, First International Symposium on Uncertainty</span>
<span class="sd">                              Modelling and Analysis, University of Maryland, Dec. 03 - Dec 05 1990, 398-403</span>

<span class="sd">    Oakley and O&#39;Hagan (2004) Probabilistic sensitivity analysis of complex models: a Bayesian approach</span>
<span class="sd">                              J. R. Statist. Soc. B 66, Part 3, 751-769.</span>

<span class="sd">    Morris (1991)             Factorial sampling plans for preliminary computational experiments,</span>
<span class="sd">                              Technometrics 33, 161-174.</span>

<span class="sd">    Saltelli et al. (2008)    Global Sensitivity Analysis. The Primer, John Wiley &amp; Sons, pp. 292</span>

<span class="sd">    Saltelli et al. (2010)    Variance based sensitivity analysis of model output, Design and estimator</span>
<span class="sd">                              for the total sensitivity index, Comp. Phys. Comm. 181, 259-270.</span>

<span class="sd">    Sobol&#39; (1990),            Sensitivity estimates for nonlinear mathematical models,</span>
<span class="sd">                              Matematicheskoe Modelirovanie 2, 112-118 (in Russian),</span>
<span class="sd">                              translated in English in Sobol&#39; (1993).</span>

<span class="sd">    Sobol&#39; (1993)             Sensitivity analysis for non-linear mathematical models,</span>
<span class="sd">                              Mathematical Modelling and Computational Experiment 1, 407-414,</span>
<span class="sd">                              English translation of Russian original paper Sobol&#39; (1990).</span>

<span class="sd">Current functions are:</span>
<span class="sd">    B                     B of Saltelli et al. (2010)</span>

<span class="sd">    G / g                 G-function attributed to Sobol&#39; (1990, 1993), given by Saltelli et al. (2008, 2010)</span>

<span class="sd">    Gstar                 G* of Saltelli et al. (2010)</span>

<span class="sd">    ishigami_homma        Ishigami and Homma (1990), given by Saltelli et al. (2008, page 179)</span>

<span class="sd">    K / bratley           K  of Saltelli et al. (2010)</span>

<span class="sd">    fmorris / morris      After Morris (1991)</span>

<span class="sd">    oakley_ohagan         Oakley and O&#39;Hagan (2004), parameters given in Saltelli et al. (2008)</span>
<span class="sd">                          or on https://www.jeremy-oakley.staff.shef.ac.uk/psa_example.txt</span>

<span class="sd">This module was written by Matthias Cuntz &amp; Juliane Mai while at</span>
<span class="sd">Department of Computational Hydrosystems, Helmholtz Centre for</span>
<span class="sd">Environmental Research - UFZ, Leipzig, Germany, and continued by</span>
<span class="sd">Matthias Cuntz while at Institut National de Recherche pour l&#39;Agriculture,</span>
<span class="sd">l&#39;Alimentation et l&#39;Environnement (INRAE), Nancy, France.</span>

<span class="sd">Copyright (c) 2015-2020 Matthias Cuntz - mc (at) macu (dot) de</span>
<span class="sd">Released under the MIT License; see LICENSE file for details.</span>

<span class="sd">* Written Mar 2015 by Matthias Cuntz (mc (at) macu (dot) de) &amp; Juliane Mai</span>
<span class="sd">* Added functions to properly test PAWN method: linear, product, ratio, and ishigami_homma_easy, Dec 2017, Juliane Mai</span>
<span class="sd">* Provide morris function under the name fmorris and the K function under the name bratley, Nov 2019, Matthias Cuntz</span>
<span class="sd">* Changed to Sphinx docstring and numpydoc, Dec 2019, Matthias Cuntz</span>
<span class="sd">* Distinguish iterable and array_like parameter types, Jan 2020, Matthias Cuntz</span>

<span class="sd">.. moduleauthor:: Matthias Cuntz</span>

<span class="sd">The following functions are provided:</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    B</span>
<span class="sd">    g</span>
<span class="sd">    G</span>
<span class="sd">    Gstar</span>
<span class="sd">    K</span>
<span class="sd">    bratley</span>
<span class="sd">    fmorris</span>
<span class="sd">    morris</span>
<span class="sd">    oakley_ohagan</span>
<span class="sd">    ishigami_homma</span>
<span class="sd">    linear</span>
<span class="sd">    product</span>
<span class="sd">    ratio</span>
<span class="sd">    ishigami_homma_easy</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Gstar&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;bratley&#39;</span><span class="p">,</span> <span class="s1">&#39;fmorris&#39;</span><span class="p">,</span> <span class="s1">&#39;morris&#39;</span><span class="p">,</span> <span class="s1">&#39;oakley_ohagan&#39;</span><span class="p">,</span> <span class="s1">&#39;ishigami_homma&#39;</span><span class="p">,</span>
           <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;ishigami_homma_easy&#39;</span><span class="p">]</span>


<span class="c1"># -----------------------------------------------------------</span>

<div class="viewcode-block" id="B"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.B">[docs]</a><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    B function, Saltelli et al. (2010) Comp. Phys. Comm. 181, p. 259-270</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    B : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of B function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameter sets are assumed to be in following ordering: (x_1, x_2, ..., X_m, w_1, w_2, ..., w_m)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must be even.&#39;</span>

    <span class="n">m</span>  <span class="o">=</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">iX</span><span class="p">[:</span><span class="n">m</span><span class="p">,:]</span><span class="o">*</span><span class="n">iX</span><span class="p">[</span><span class="n">m</span><span class="p">:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="g"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.g">[docs]</a><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    G-function</span>

<span class="sd">    Sobol&#39; (1990) Matematicheskoe Modelirovanie 2, 112-118 (in Russian)</span>

<span class="sd">    Sobol&#39; (1993) Mathematical Modelling and Computational Experiment 1, 407-414 (English translation)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>
<span class="sd">    a : array_like</span>
<span class="sd">        (nX,) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    G : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of G function values at `X` with parameters `a`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Gstar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">a</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="G"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.G">[docs]</a><span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    G-function</span>

<span class="sd">    Sobol&#39; (1990) Matematicheskoe Modelirovanie 2, 112-118 (in Russian)</span>

<span class="sd">    Sobol&#39; (1993) Mathematical Modelling and Computational Experiment 1, 407-414 (English translation)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>
<span class="sd">    a : array_like</span>
<span class="sd">        (nX,) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    g : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of G function values at `X` with parameters `a`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Gstar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">a</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="Gstar"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.Gstar">[docs]</a><span class="k">def</span> <span class="nf">Gstar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    G* example, Saltelli et al. (2010) Comp. Phys. Comm., 181, p. 259-270</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>
<span class="sd">    alpha : array_like</span>
<span class="sd">        (nX,) array of floats</span>
<span class="sd">    delta : array_like</span>
<span class="sd">        (nX,) array of floats</span>
<span class="sd">    a : array_like</span>
<span class="sd">        (nX,) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    G* : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of G* function values at `X` with parameters `alpha`, `delta` and `a`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X: dim1 = # of parameters = 10</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">nalpha</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nalpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">size</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nalpha</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must len(alpha).&#39;</span>

    <span class="n">ialpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nalpha</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">idelta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nalpha</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ia</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nalpha</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">ialpha</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">iX</span><span class="o">+</span><span class="n">idelta</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">iX</span><span class="o">+</span><span class="n">idelta</span><span class="p">))</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="n">ialpha</span><span class="o">+</span><span class="n">ia</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ia</span><span class="p">)</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">yi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="linear"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.linear">[docs]</a><span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear test function to test PAWN method:</span>

<span class="sd">        `Y = a*X + b`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (1,) or (1,npoints) array of floats</span>
<span class="sd">    a : array_like</span>
<span class="sd">        float or (npoints,) array of floats</span>
<span class="sd">    b : array_like</span>
<span class="sd">        float or (npoints,) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    linear : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of linear function values at `X` with parameters `a` and `b`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X:    dim1 = # of parameters = 1</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must 1.&#39;</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">b</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="product"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.product">[docs]</a><span class="k">def</span> <span class="nf">product</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Product test function to test PAWN method:</span>

<span class="sd">        `Y = X[0] * X[1]`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (2,) or (2,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    product : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of product function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X:    dim1 = # of parameters = 2</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must 2.&#39;</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">iX</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="ratio"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.ratio">[docs]</a><span class="k">def</span> <span class="nf">ratio</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ratio test function:</span>

<span class="sd">        `Y = X[0] / X[1]`</span>

<span class="sd">    Simple nonlinear model proposed by Liu et al. (2006):</span>

<span class="sd">        Liu, H., Sudjianto, A., Chen, W., 2006.</span>
<span class="sd">        Relative entropy based method for probabilistic sensitivity analysis in engineering design.</span>
<span class="sd">        J. Mech. Des. 128, 326-336.</span>

<span class="sd">    Used by Pianosi &amp; Wagener, Environmental Modelling &amp; Software (2015)</span>

<span class="sd">        Pianosi, F. &amp; Wagener T., 2015</span>
<span class="sd">        A simple and efficient method for global sensitivity analysis based on cumulative distribution functions.</span>
<span class="sd">        Environmental Modelling &amp; Software 67, 1-11.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (2,) or (2,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ratio : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of ratio function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X:    dim1 = # of parameters = 2</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must 2.&#39;</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">/</span> <span class="n">iX</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="ishigami_homma_easy"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.ishigami_homma_easy">[docs]</a><span class="k">def</span> <span class="nf">ishigami_homma_easy</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified Ishigami and Homma function to test PAWN method:</span>

<span class="sd">        `Y = sin(X[0]) + X[1]`</span>

<span class="sd">    with `X[0],X[1]` ~ `Uniform[-Pi,Pi]`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (2,) or (2,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ishigami_homma_easy : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of simplified Ishigami and Homma function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X:    dim1 = # of parameters = 2</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must 2.&#39;</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>  <span class="o">+</span> <span class="n">iX</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="ishigami_homma"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.ishigami_homma">[docs]</a><span class="k">def</span> <span class="nf">ishigami_homma</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ishigami and Homma (1990), given by Saltelli et al. (2008, page 179)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (3,) or (3,npoints) array of floats</span>
<span class="sd">    a : array_like</span>
<span class="sd">        float or (npoints,) array of floats</span>
<span class="sd">    b : array_like</span>
<span class="sd">        float or (npoints,) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ishigami_homma : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of Ishigami and Homma function values at `X` with parameters `a` and `b`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X: dim1 = # of parameters = 3</span>
    <span class="c1">#       dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must be 3.&#39;</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>  <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iX</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]))</span><span class="o">**</span><span class="mi">2</span>  <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">iX</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">4</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iX</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="K"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.K">[docs]</a><span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    K example, Saltelli et al. (2010) Comp. Phys. Comm., 181, p. 259-270</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    K : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of K function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Model output for given parameter set(s) is returned</span>
    <span class="c1"># X: dim1 = # of parameters = 10</span>
    <span class="c1">#    dim2 = # of parameter sets</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must be &gt; 1.&#39;</span>

    <span class="n">nX</span> <span class="o">=</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nX</span><span class="p">):</span>
        <span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nX</span><span class="p">):</span>
        <span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">iX</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<div class="viewcode-block" id="bratley"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.bratley">[docs]</a><span class="k">def</span> <span class="nf">bratley</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    K example, Saltelli et al. (2010) Comp. Phys. Comm., 181, p. 259-270</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (nX,) or (nX,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bratley : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of K function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">K</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="fmorris"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.fmorris">[docs]</a><span class="k">def</span> <span class="nf">fmorris</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span><span class="p">,</span> <span class="n">beta3</span><span class="p">,</span> <span class="n">beta4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Morris-function, Morris (1991) Technometrics 33, 161-174</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (20,) or (20,npoints) array of floats</span>
<span class="sd">    beta0 : float</span>
<span class="sd">        float</span>
<span class="sd">    beta1 : array_like</span>
<span class="sd">        (20,) array of floats</span>
<span class="sd">    beta2 : array_like</span>
<span class="sd">        (20,20) array of floats</span>
<span class="sd">    beta3 : array_like</span>
<span class="sd">        (20,20,20) array of floats</span>
<span class="sd">    beta4 : array_like</span>
<span class="sd">        (20,20,20,20) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fmorris : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of Morris function values at `X` with parameters `beta0-beta4`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="n">om</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">iX</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">om</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.1</span><span class="o">*</span><span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span><span class="o">/</span><span class="p">(</span><span class="n">iX</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="n">nn</span>  <span class="o">=</span> <span class="mi">20</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nn</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">beta1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">nn</span><span class="p">),</span> <span class="s1">&#39;beta1.shape must be all &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">beta2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">nn</span><span class="p">),</span> <span class="s1">&#39;beta2.shape must be all &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">beta3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">nn</span><span class="p">),</span> <span class="s1">&#39;beta3.shape must be all &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">beta4</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">nn</span><span class="p">),</span> <span class="s1">&#39;beta4.shape must be all &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>

    <span class="n">y</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">beta0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nn</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[:]</span> <span class="o">+=</span> <span class="n">beta1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nn</span><span class="p">):</span>
            <span class="n">y</span><span class="p">[:]</span> <span class="o">+=</span> <span class="n">beta2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nn</span><span class="p">):</span>
                <span class="n">y</span><span class="p">[:]</span> <span class="o">+=</span> <span class="n">beta3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">l</span><span class="p">,:]</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nn</span><span class="p">):</span>
                    <span class="n">y</span><span class="p">[:]</span> <span class="o">+=</span> <span class="n">beta4</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">s</span><span class="p">]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">l</span><span class="p">,:]</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="n">s</span><span class="p">,:]</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span></div>


<div class="viewcode-block" id="morris"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.morris">[docs]</a><span class="k">def</span> <span class="nf">morris</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Morris-function, Morris (1991) Technometrics 33, 161-174</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (20,) or (20,npoints) array of floats</span>
<span class="sd">    beta0 : float</span>
<span class="sd">        float</span>
<span class="sd">    beta1 : array_like</span>
<span class="sd">        (20,) array of floats</span>
<span class="sd">    beta2 : array_like</span>
<span class="sd">        (20,20) array of floats</span>
<span class="sd">    beta3 : array_like</span>
<span class="sd">        (20,20,20) array of floats</span>
<span class="sd">    beta4 : array_like</span>
<span class="sd">        (20,20,20,20) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    morris : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of Morris function values at `X` with parameters `beta0-beta4`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">fmorris</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<div class="viewcode-block" id="oakley_ohagan"><a class="viewcode-back" href="../../../functions.sa_test_functions.html#hesseflux.functions.sa_test_functions.oakley_ohagan">[docs]</a><span class="k">def</span> <span class="nf">oakley_ohagan</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Oakley and O&#39;Hagan (2004) J. R. Statist. Soc. B 66, Part 3, 751-769</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        (15,) or (15,npoints) array of floats</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    oakley_ohagan : float or ndarray</span>
<span class="sd">        float or (npoints,) floats of Oakley and O&#39;Hagan function values at `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">iX</span> <span class="o">=</span> <span class="n">X</span>

    <span class="n">nn</span> <span class="o">=</span> <span class="mi">15</span>

    <span class="k">assert</span> <span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nn</span><span class="p">,</span> <span class="s1">&#39;X.shape[0] must &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="mf">1.07</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.20</span><span class="p">])</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">1.04</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">2.47</span><span class="p">,</span> <span class="mf">2.39</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">2.26</span><span class="p">])</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">1.03</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="mf">2.21</span><span class="p">,</span> <span class="mf">2.04</span><span class="p">,</span> <span class="mf">2.40</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">1.98</span><span class="p">])</span>
    <span class="n">M</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span>   <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.37</span><span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span>  <span class="mf">0.71</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.22</span><span class="p">,</span>  <span class="mf">0.06</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.26</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span>   <span class="mf">0.26</span><span class="p">,</span>  <span class="mf">0.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">,</span>   <span class="mf">0.42</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>   <span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.06</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>    <span class="mf">0.1</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span>  <span class="mf">0.22</span><span class="p">,</span>  <span class="mf">0.15</span><span class="p">,</span>   <span class="mf">0.29</span><span class="p">,</span>  <span class="mf">0.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21</span><span class="p">,</span>  <span class="mf">0.43</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.04</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.66</span><span class="p">,</span>  <span class="mf">0.43</span><span class="p">,</span>   <span class="mf">0.3</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39</span><span class="p">,</span>  <span class="mf">0.18</span><span class="p">,</span>   <span class="mf">0.06</span><span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span>  <span class="mf">0.12</span><span class="p">,</span>   <span class="mf">0.11</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22</span><span class="p">,</span>  <span class="mf">0.19</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07</span><span class="p">,</span>   <span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>   <span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mf">0.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.37</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span>   <span class="mf">0.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.52</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.04</span><span class="p">,</span>  <span class="mf">0.36</span><span class="p">,</span>  <span class="mf">0.31</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.08</span><span class="p">,</span>  <span class="mf">0.004</span><span class="p">,</span>  <span class="mf">0.89</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.09</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.06</span><span class="p">,</span>  <span class="mf">0.14</span><span class="p">,</span>  <span class="mf">0.21</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.09</span><span class="p">,</span>  <span class="mf">0.59</span><span class="p">,</span>   <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>   <span class="mf">0.03</span><span class="p">,</span>   <span class="mf">0.1</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.34</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.61</span><span class="p">,</span>  <span class="mf">0.08</span><span class="p">,</span>  <span class="mf">0.89</span><span class="p">,</span>  <span class="mf">0.14</span><span class="p">,</span>  <span class="mf">0.15</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.53</span><span class="p">,</span>   <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.58</span><span class="p">,</span>  <span class="mf">0.37</span><span class="p">,</span>  <span class="mf">0.11</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.57</span><span class="p">,</span>  <span class="mf">0.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">,</span>  <span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.39</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32</span><span class="p">,</span>   <span class="mf">0.09</span><span class="p">,</span>  <span class="mf">0.07</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.57</span><span class="p">,</span>  <span class="mf">0.53</span><span class="p">,</span>  <span class="mf">0.24</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.23</span><span class="p">,</span>  <span class="mf">0.14</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.56</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.66</span><span class="p">,</span>  <span class="mf">0.35</span><span class="p">,</span>   <span class="mf">0.14</span><span class="p">,</span>  <span class="mf">0.52</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.28</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.07</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>   <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">0.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16</span><span class="p">,</span>  <span class="mf">0.22</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.09</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.32</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span>   <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.13</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.18</span><span class="p">,</span>   <span class="mf">0.06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.62</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.29</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span>   <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.41</span><span class="p">,</span>   <span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span>  <span class="mf">0.41</span><span class="p">,</span>  <span class="mf">0.27</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.24</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44</span><span class="p">,</span>   <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.07</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>   <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span>  <span class="mf">0.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>   <span class="mf">0.11</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.76</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26</span><span class="p">,</span>   <span class="mf">0.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.003</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.23</span><span class="p">,</span>  <span class="mf">0.38</span><span class="p">,</span>  <span class="mf">0.46</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.17</span><span class="p">,</span>  <span class="mf">0.16</span><span class="p">]</span> <span class="p">])</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">iX</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iX</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iX</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">iX</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">iX</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">isone</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span></div>


<span class="c1"># -----------------------------------------------------------</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">NORMALIZE_WHITESPACE</span><span class="p">)</span>

    <span class="c1"># ishigami_homma([np.pi/2.,np.pi/2.,1.], 1., 1.)</span>
    <span class="c1"># # 3.0</span>
    <span class="c1"># B(np.arange(10))</span>
    <span class="c1"># # 80</span>
    <span class="c1"># B(np.arange(12).reshape(6,2))</span>
    <span class="c1"># # array([56, 89])</span>
    <span class="c1"># linear(np.ones(1), 1., 1.)</span>
    <span class="c1"># # 2.0</span>
    <span class="c1"># product(np.arange(2)+1.)</span>
    <span class="c1"># # 2.0</span>
    <span class="c1"># ratio(np.arange(2)+1.)</span>
    <span class="c1"># # 0.5</span>
    <span class="c1"># ishigami_homma_easy([np.pi/2.,1.])</span>
    <span class="c1"># # 2.0</span>
    <span class="c1"># bratley(np.arange(5)+1.)</span>
    <span class="c1"># K(np.arange(5)+1.)</span>
    <span class="c1"># # -101.0</span>
    <span class="c1"># K(np.arange(8).reshape((4,2))+1.)</span>
    <span class="c1"># # [ 92., 342.]</span>
    <span class="c1"># oakley_ohagan(np.zeros(15))</span>
    <span class="c1"># # 15.75</span>
    <span class="c1"># Gstar(np.ones(5), np.zeros(5), np.ones(5), np.zeros(5))</span>
    <span class="c1"># # 1.0</span>
    <span class="c1"># g(np.ones(5), np.zeros(5))</span>
    <span class="c1"># G(np.ones(5), np.zeros(5))</span>
    <span class="c1"># # 32.0</span>

    <span class="c1"># # Morris function</span>
    <span class="c1"># seed = 1234</span>
    <span class="c1"># np.random.seed(seed=seed)</span>
    <span class="c1"># npars = 20</span>
    <span class="c1"># x0 = np.ones(npars)*0.5</span>
    <span class="c1"># lb = np.zeros(npars)</span>
    <span class="c1"># ub = np.ones(npars)</span>
    <span class="c1"># beta0              = 0.</span>
    <span class="c1"># beta1              = np.random.standard_normal(npars)</span>
    <span class="c1"># beta1[:10]         = 20.</span>
    <span class="c1"># beta2              = np.random.standard_normal((npars,npars))</span>
    <span class="c1"># beta2[:6,:6]       = -15.</span>
    <span class="c1"># beta3              = np.zeros((npars,npars,npars))</span>
    <span class="c1"># beta3[:5,:5,:5]    = -10.</span>
    <span class="c1"># beta4              = np.zeros((npars,npars,npars,npars))</span>
    <span class="c1"># beta4[:4,:4,:4,:4] = 5.</span>
    <span class="c1"># mm = fmorris(np.linspace(0,2*(npars-1),npars)/float(2*npars-1), beta0, beta1, beta2, beta3, beta4)</span>
    <span class="c1"># print(np.around(mm,3))</span>
    <span class="c1"># # -82.711</span>
    <span class="c1"># mm = fmorris(np.arange(2*npars,dtype=np.float).reshape((npars,2))/float(2*npars-1),</span>
    <span class="c1">#              beta0, beta1, beta2, beta3, beta4)</span>
    <span class="c1"># print(np.around(mm,3))</span>
    <span class="c1"># # [-82.711 -60.589]</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../contents.html">hesseflux</a></h1>



<p class="blurb">Functions used in the processing and post-processing of Eddy covariance flux data</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">hesseflux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Authors</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/mcuntz/hesseflux">hesseflux @ GitHub</a></li>
    
    <li class="toctree-l1"><a href="https://doi.org/10.5281/zenodo.3831488">hesseflux @ Zenodo</a></li>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/hesseflux/">hesseflux @ PyPI</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../contents.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2022, Matthias Cuntz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>