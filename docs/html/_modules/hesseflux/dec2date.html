
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hesseflux.dec2date &#8212; hesseflux 0.0.0.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for hesseflux.dec2date</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">dec2date : Converts decimal dates to calendar dates.</span>

<span class="sd">This module was written by Arndt Piayda and then enhanced and</span>
<span class="sd">maintained by Matthias Cuntz while at Department of Computational</span>
<span class="sd">Hydrosystems, Helmholtz Centre for Environmental Research - UFZ,</span>
<span class="sd">Leipzig, Germany, and continued by Matthias Cuntz while at Institut</span>
<span class="sd">National de Recherche pour l&#39;Agriculture, l&#39;Alimentation et</span>
<span class="sd">l&#39;Environnement (INRAE), Nancy, France.</span>

<span class="sd">Copyright (c) 2010-2020 Matthias Cuntz - mc (at) macu (dot) de</span>
<span class="sd">Released under the MIT License; see LICENSE file for details.</span>

<span class="sd">* Written Jun 2010 by Arndt Piayda</span>
<span class="sd">* Input can be scalar, list, array, or mix of it, Feb 2012, Matthias Cuntz</span>
<span class="sd">* Changed checks, added calendars decimal and decimal360, Feb 2012, Matthias Cuntz</span>
<span class="sd">* fulldate=True default, Feb 2012, Matthias Cuntz</span>
<span class="sd">* Change keyword name: units -&gt; refdate, Jun 2012, Matthias Cuntz</span>
<span class="sd">* units has now same meaning as in netcdftime, Jun 2012, Matthias Cuntz</span>
<span class="sd">* Include cdo absolute date units &#39;day as %Y%m%d.%f&#39;, Jun 2012, Matthias Cuntz</span>
<span class="sd">* Solved Excel leap year problem, Feb 2013, Matthias Cuntz</span>
<span class="sd">* Ported to Python 3, Feb 2013, Matthias Cuntz</span>
<span class="sd">* Small bug in eng output, May 2013, Arndt Piayda</span>
<span class="sd">* Excel starts at 1 not at 0 on 01 January 1900 or 1904, Oct 2013, Matthias Cuntz</span>
<span class="sd">* Bug: 01.01.0001 was substracted if Julian calendar even with units given, Oct 2013, Matthias Cuntz</span>
<span class="sd">* Include units &#39;month as %Y%m.%f&#39; and &#39;year as %Y.%f&#39;, May 2016, Matthias Cuntz</span>
<span class="sd">* Adapted to new netCDF4/netcdftime (&gt;= v1.0) and datetime (&gt;= Python v2.7.9), Jun 2015, Matthias Cuntz</span>
<span class="sd">* leap always integer, Oct 2016, Matthias Cuntz</span>
<span class="sd">* Using numpy docstring format, May 2020, Matthias Cuntz</span>
<span class="sd">* Succeed eng by en keyword as in ascii2ascii and date2dec, Jul 2020, Matthias Cuntz</span>
<span class="sd">* proleptic_gregorian instead of gregorian calendar for Excel dates, Jul 2020, Matthias Cuntz</span>

<span class="sd">.. moduleauthor:: Matthias Cuntz, Arndt Piayda</span>

<span class="sd">The following functions are provided</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   dec2date</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dec2date&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="dec2date"><a class="viewcode-back" href="../../dec2date.html#hesseflux.dec2date.dec2date">[docs]</a><span class="k">def</span> <span class="nf">dec2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">refdate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">excelerr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fulldate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">mo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">sc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">en</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eng</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts scale and array_like with decimal dates into</span>
<span class="sd">    calendar dates. Supported time formats are:</span>
<span class="sd">    standard, gregorian, julian, proleptic_gregorian,</span>
<span class="sd">    excel1900, excel1904, 365_day, noleap, 366_day, all_leap,</span>
<span class="sd">    and 360_day.</span>

<span class="sd">    Input is decimal date in units of days.</span>

<span class="sd">    Output is year, month, day, hour, minute, second</span>
<span class="sd">    or any combination of them. Output in string format is possible.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    indata : array_like</span>
<span class="sd">        Input decimal dates. Dates must be positive.</span>
<span class="sd">    calendar : str, optional</span>
<span class="sd">        Calendar of input dates (default: &#39;standard&#39;).</span>

<span class="sd">        Possible values are:</span>

<span class="sd">        &#39;standard&#39;, &#39;gregorian&#39; = julian calendar from</span>
<span class="sd">        01.01.-4712 12:00:00 (BC) until 05.03.1583 00:00:00 and</span>
<span class="sd">        gregorian calendar from 15.03.1583 00:00:00 until now.</span>
<span class="sd">        Missing 10 days do not exsist.</span>

<span class="sd">        &#39;julian&#39; = julian calendar from 01.01.-4712 12:00:00 (BC)</span>
<span class="sd">         until now.</span>

<span class="sd">        &#39;proleptic_gregorian&#39; = gregorian calendar from</span>
<span class="sd">        01.01.0001 00:00:00 until now.</span>

<span class="sd">        &#39;excel1900&#39; = Excel dates with origin at</span>
<span class="sd">        01.01.1900 00:00:00.</span>

<span class="sd">        &#39;excel1904&#39; = Excel 1904 (Lotus) format.</span>
<span class="sd">        Same as excel1904 but with origin at</span>
<span class="sd">        01.01.1904 00:00:00.</span>

<span class="sd">        &#39;365_day&#39;, &#39;noleap&#39; = 365 days format,</span>
<span class="sd">        i.e. common years only (no leap years)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;366_day&#39;, &#39;all_leap&#39; = 366 days format,</span>
<span class="sd">        i.e. leap years only (no common years)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;360_day&#39; = 360 days format,</span>
<span class="sd">        i.e. years with only 360 days (30 days per month)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;decimal&#39; = decimal year instead of decimal days.</span>

<span class="sd">        &#39;decimal360&#39; = decimal year with a year of 360 days, i.e. 12 month with 30 days each.</span>


<span class="sd">    Optional Arguments</span>
<span class="sd">    ------------------</span>
<span class="sd">    refdate : str, optional</span>
<span class="sd">        Reference date for &#39;days since refdate&#39; can be set by user. Input must be a</span>
<span class="sd">        string in the format &#39;yyyy-mm-dd hh:mm:ss&#39;.</span>
<span class="sd">        Default values for different `calendars` are set automatically.</span>
<span class="sd">    units : str, optional</span>
<span class="sd">        Units of the the time stamp can be given. This can only be the following two:</span>

<span class="sd">        &#39;day as %Y%m%d.%f&#39;, or</span>

<span class="sd">        &#39;days since refdate&#39;, with refdate in the format &#39;yyyy-mm-dd hh:mm:ss&#39;.</span>

<span class="sd">        If `units=&#39;day as %Y%m%d.%f&#39;` then `calendar` is ignored and the dates will be returned</span>
<span class="sd">        assuming that %f is fractional date from 00:00:00 h.</span>
<span class="sd">    excelerr : bool, optional</span>
<span class="sd">       In Excel, the year 1900 is normally considered a leap year,</span>
<span class="sd">       which it was not. By default, this error is taken into account</span>
<span class="sd">       if calendar=&#39;excel1900&#39; (default: True).</span>

<span class="sd">       1900 is not considered a leap year if excelerr=False.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of array_like</span>
<span class="sd">        `fulldate` -&gt; output arrays with year, month, day, hour, minute, second</span>

<span class="sd">                      Default fulldate is overwritten by selection of special output `yr`,`mn`,`dy`,`hr`,`mi`,`sc`</span>

<span class="sd">        `yr`       -&gt; output array with year</span>

<span class="sd">        `mo`       -&gt; output array with month</span>

<span class="sd">        `dy`       -&gt; output array with day</span>

<span class="sd">        `hr`       -&gt; output array with hour</span>

<span class="sd">        `mi`       -&gt; output array with minute</span>

<span class="sd">        `sc`       -&gt; output array with second</span>

<span class="sd">        `ascii`    -&gt; output array with strings of the format &#39;dd.mm.yyyy hh:mm:ss&#39;</span>

<span class="sd">        `en`      -&gt; output array with strings of the format &#39;yyyy-mm-dd hh:mm:ss&#39;</span>

<span class="sd">        `eng`     -&gt; Same as en: obsolete.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Most versions of `datetime do` not support negative years,</span>
<span class="sd">    i.e. Julian days &lt; 1721423.5 = 01.01.0001 00:00.</span>

<span class="sd">    There is an issue in `netcdftime` version &lt; 0.9.5 in proleptic_gregorian for dates before year 301:</span>
<span class="sd">      dec2date(date2dec(ascii=&#39;01.01.0300 00:00:00&#39;, calendar=&#39;proleptic_gregorian&#39;), calendar=&#39;proleptic_gregorian&#39;)</span>
<span class="sd">        [300, 1, 2, 0, 0, 0]</span>
<span class="sd">      dec2date(date2dec(ascii=&#39;01.01.0301 00:00:00&#39;, calendar=&#39;proleptic_gregorian&#39;), calendar=&#39;proleptic_gregorian&#39;)</span>
<span class="sd">        [301, 1, 1, 0, 0, 0]</span>

<span class="sd">    Requires `netcdftime.py` from module netcdftime available at:</span>
<span class="sd">        http://netcdf4-python.googlecode.com</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    # Some implementations of datetime have problems with negative years</span>
<span class="sd">    &gt;&gt;&gt; import datetime</span>
<span class="sd">    &gt;&gt;&gt; if datetime.MINYEAR &gt; 0:</span>
<span class="sd">    ...     print(&#39;The minimum year in your datetime implementation is &#39;, datetime.MINYEAR)</span>
<span class="sd">    ...     print(&#39;i.e. it does not support negative years (BC).&#39;)</span>
<span class="sd">    The minimum year in your datetime implementation is  1</span>
<span class="sd">    i.e. it does not support negative years (BC).</span>

<span class="sd">    #calendar = &#39;standard&#39;</span>
<span class="sd">    &gt;&gt;&gt; year   = np.array([2000,1810,1630,1510,1271,619,1])</span>
<span class="sd">    &gt;&gt;&gt; month  = np.array([1,4,7,9,3,8,1])</span>
<span class="sd">    &gt;&gt;&gt; day    = np.array([5,24,15,20,18,27,1])</span>
<span class="sd">    &gt;&gt;&gt; hour   = np.array([12,16,10,14,19,11,12])</span>
<span class="sd">    &gt;&gt;&gt; minute = np.array([30,15,20,35,41,8,0])</span>
<span class="sd">    &gt;&gt;&gt; second = np.array([15,10,40,50,34,37,0])</span>
<span class="sd">    &gt;&gt;&gt; from date2dec import date2dec</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;standard&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; year1, month1, day1, hour1, minute1, second1 = dec2date(decimal, calendar= &#39;standard&#39;, fulldate=True)</span>
<span class="sd">    &gt;&gt;&gt; print(year1)</span>
<span class="sd">    [2000 1810 1630 1510 1271  619    1]</span>
<span class="sd">    &gt;&gt;&gt; print(month1)</span>
<span class="sd">    [1 4 7 9 3 8 1]</span>
<span class="sd">    &gt;&gt;&gt; print(day1)</span>
<span class="sd">    [ 5 24 15 20 18 27  1]</span>
<span class="sd">    &gt;&gt;&gt; print(hour1)</span>
<span class="sd">    [12 16 10 14 19 11 12]</span>
<span class="sd">    &gt;&gt;&gt; print(minute1)</span>
<span class="sd">    [30 15 20 35 41  8  0]</span>
<span class="sd">    &gt;&gt;&gt; print(second1)</span>
<span class="sd">    [15 10 40 50 34 37  0]</span>

<span class="sd">    # calendar = &#39;julian&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;julian&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; year1 = dec2date(decimal, calendar=&#39;julian&#39;, yr=True)</span>
<span class="sd">    &gt;&gt;&gt; print(year1)</span>
<span class="sd">    [2000 1810 1630 1510 1271  619    1]</span>

<span class="sd">    # calendar = &#39;proleptic_gregorian&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;proleptic_gregorian&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; ascii = dec2date(decimal, calendar=&#39;proleptic_gregorian&#39;, ascii=True)</span>
<span class="sd">    &gt;&gt;&gt; print(ascii[::4])</span>
<span class="sd">    [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>

<span class="sd">    # calendar = &#39;excel1900&#39; WITH excelerr = True -&gt; 1900 considered as leap year</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; year1, day1 = dec2date(decimal, calendar=&#39;excel1900&#39;, yr=True, dy=True)</span>
<span class="sd">    &gt;&gt;&gt; print(year1)</span>
<span class="sd">    [2000 1810 1630 1510 1271  619    1]</span>
<span class="sd">    &gt;&gt;&gt; print(day1)</span>
<span class="sd">    [ 5 24 15 20 18 27  1]</span>

<span class="sd">    # calendar = &#39;excel1900&#39; WITH excelerr = False -&gt; 1900 considered as NO leap year</span>
<span class="sd">    # Older versions of netcdftime.py produced unnecessary output (Line 262)</span>
<span class="sd">    # &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;,yr=year,mo=month,dy=day,hr=hour,mi=minute,sc=second,excelerr=False)</span>
<span class="sd">    # &gt;&gt;&gt; if nt.__version__ &lt; &#39;0.9.4&#39;:</span>
<span class="sd">    # ...     asciidate = dec2date(decimal, calendar=&#39;excel1900&#39;, ascii = True, excelerr = False)</span>
<span class="sd">    # ... elif nt.__version__ == &#39;0.9.4&#39;:</span>
<span class="sd">    # ...     asciidate = dec2date(decimal, calendar=&#39;excel1900&#39;, ascii = True, excelerr = False)</span>
<span class="sd">    # ...     for i in range(3):</span>
<span class="sd">    # ...         print(&#39;0 300&#39;)</span>
<span class="sd">    # ... else:</span>
<span class="sd">    # ...     asciidate = dec2date(decimal, calendar=&#39;excel1900&#39;, ascii = True, excelerr = False)</span>
<span class="sd">    # ...     for i in range(7):</span>
<span class="sd">    # ...         print(&#39;0 300&#39;)</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>
<span class="sd">    # 0 300</span>

<span class="sd">    # &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    # [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>

<span class="sd">    # calendar = &#39;excel1904&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1904&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; asciidate = dec2date(decimal, calendar=&#39;excel1904&#39;, ascii = True)</span>
<span class="sd">    &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>
<span class="sd">    &gt;&gt;&gt; asciidate = dec2date(decimal, calendar=&#39;excel1904&#39;, ascii=True, refdate=&#39;1909-12-31 00:00:00&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    [&#39;05.01.2006 12:30:15&#39; &#39;18.03.1277 19:41:34&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(decimal[::4], calendar=&#39;excel1904&#39;, ascii=True, units=&#39;days since 1909-12-31 00:00:00&#39;))</span>
<span class="sd">    [&#39;05.01.2006 12:30:15&#39; &#39;18.03.1277 19:41:34&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(decimal[::4], calendar=&#39;excel1904&#39;, ascii=True, units=&#39;days since 1910-01-01 00:00:00&#39;))</span>
<span class="sd">    [&#39;06.01.2006 12:30:15&#39; &#39;19.03.1277 19:41:34&#39;]</span>

<span class="sd">    # check especially 1900 (no) leap year in Excel</span>
<span class="sd">    &gt;&gt;&gt; year1   = np.array([1900,1900,1900,1900])</span>
<span class="sd">    &gt;&gt;&gt; month1  = np.array([2,2,3,1])</span>
<span class="sd">    &gt;&gt;&gt; day1    = np.array([28,29,1,1])</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;, yr=year1, mo=month1, dy=day1)</span>
<span class="sd">    &gt;&gt;&gt; month2, day2 = dec2date(decimal, calendar=&#39;excel1900&#39;, mo=True, dy=True)</span>
<span class="sd">    &gt;&gt;&gt; print(month2)</span>
<span class="sd">    [2 2 3 1]</span>
<span class="sd">    &gt;&gt;&gt; print(day2)</span>
<span class="sd">    [28 29  1  1]</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;, yr=year1, mo=month1, dy=day1, excelerr=False)</span>
<span class="sd">    &gt;&gt;&gt; month2, day2 = dec2date(decimal, calendar=&#39;excel1900&#39;, mo=True, dy=True, excelerr=False)</span>
<span class="sd">    &gt;&gt;&gt; print(month2)</span>
<span class="sd">    [2 3 3 1]</span>
<span class="sd">    &gt;&gt;&gt; print(day2)</span>
<span class="sd">    [28  1  1  1]</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1904&#39;, yr=year1, mo=month1, dy=day1)</span>
<span class="sd">    &gt;&gt;&gt; month2, day2 = dec2date(decimal, calendar=&#39;excel1904&#39;, mo=True, dy=True)</span>
<span class="sd">    &gt;&gt;&gt; print(month2)</span>
<span class="sd">    [2 3 3 1]</span>
<span class="sd">    &gt;&gt;&gt; print(day2)</span>
<span class="sd">    [28  1  1  1]</span>

<span class="sd">    # calendar = &#39;365_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;365_day&#39;,yr=year,mo=month,dy=day,hr=hour,mi=minute,sc=second)</span>
<span class="sd">    &gt;&gt;&gt; asciidate = dec2date(decimal, calendar=&#39;365_day&#39;, ascii = True)</span>
<span class="sd">    &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>

<span class="sd">    # calendar = &#39;366_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;366_day&#39;,yr=year,mo=month,dy=day,hr=hour,mi=minute,sc=second)</span>
<span class="sd">    &gt;&gt;&gt; asciidate = dec2date(decimal, calendar=&#39;366_day&#39;, ascii = True)</span>
<span class="sd">    &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>

<span class="sd">    # calendar = &#39;360_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;360_day&#39;,yr=year,mo=month,dy=day,hr=hour,mi=minute,sc=second)</span>
<span class="sd">    &gt;&gt;&gt; asciidate = dec2date(decimal, calendar=&#39;360_day&#39;, ascii = True)</span>
<span class="sd">    &gt;&gt;&gt; print(asciidate[::4])</span>
<span class="sd">    [&#39;05.01.2000 12:30:15&#39; &#39;18.03.1271 19:41:34&#39;]</span>

<span class="sd">    &gt;&gt;&gt; print(dec2date(719644.52101, calendar=&#39;proleptic_gregorian&#39;, ascii = True))</span>
<span class="sd">    28.04.1971 12:30:15</span>
<span class="sd">    &gt;&gt;&gt; dec = date2dec(ascii=&#39;02.03.1910 03:44:55&#39;, calendar=&#39;decimal&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(dec, calendar=&#39;decimal&#39;, ascii=True))</span>
<span class="sd">    02.03.1910 03:44:55</span>
<span class="sd">    &gt;&gt;&gt; dec = date2dec(ascii=&#39;02.03.1910 03:44:55&#39;, calendar=&#39;decimal360&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(dec, calendar=&#39;decimal360&#39;, ascii=True))</span>
<span class="sd">    02.03.1910 03:44:55</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date([dec,dec], calendar=&#39;decimal360&#39;, ascii=True))</span>
<span class="sd">    [&#39;02.03.1910 03:44:55&#39;, &#39;02.03.1910 03:44:55&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date([[dec,dec],[dec,dec],[dec,dec]], calendar=&#39;decimal360&#39;, ascii=True)[0])</span>
<span class="sd">    [&#39;02.03.1910 03:44:55&#39;, &#39;02.03.1910 03:44:55&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(np.array([dec,dec]), calendar=&#39;decimal360&#39;, ascii=True))</span>
<span class="sd">    [&#39;02.03.1910 03:44:55&#39; &#39;02.03.1910 03:44:55&#39;]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(np.array([[dec,dec],[dec,dec],[dec,dec]]), calendar=&#39;decimal360&#39;, ascii=True)[0:2,0])</span>
<span class="sd">    [&#39;02.03.1910 03:44:55&#39; &#39;02.03.1910 03:44:55&#39;]</span>

<span class="sd">    &gt;&gt;&gt; absolut = np.array([20070102.0034722, 20070102.0069444])</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(absolut, units=&#39;day as %Y%m%d.%f&#39;, ascii=True))</span>
<span class="sd">    [&#39;02.01.2007 00:05:00&#39; &#39;02.01.2007 00:10:00&#39;]</span>
<span class="sd">    &gt;&gt;&gt; absolut = [20070102.0034722, 20070102.0069444]</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(absolut, units=&#39;day as %Y%m%d.%f&#39;, ascii=True))</span>
<span class="sd">    [&#39;02.01.2007 00:05:00&#39;, &#39;02.01.2007 00:10:00&#39;]</span>

<span class="sd">    &gt;&gt;&gt; absolut = np.array([200401.5, 200402.5, 201011.5, 201002.5])</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(absolut, units=&#39;month as %Y%m.%f&#39;, ascii=True))</span>
<span class="sd">    [&#39;15.01.2004 12:00:00&#39; &#39;14.02.2004 12:00:00&#39; &#39;15.11.2010 00:00:00&#39; &#39;14.02.2010 00:00:00&#39;]</span>

<span class="sd">    &gt;&gt;&gt; absolut = np.array([2004.5, 2010.5])</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(absolut, units=&#39;year as %Y.%f&#39;, ascii=True))</span>
<span class="sd">    [&#39;01.07.2004 00:00:00&#39; &#39;01.07.2010 12:00:00&#39;]</span>

<span class="sd">    # en, eng</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(719644.52101, calendar=&#39;proleptic_gregorian&#39;, en=True))</span>
<span class="sd">    1971-04-28 12:30:15</span>
<span class="sd">    &gt;&gt;&gt; print(dec2date(719644.52101, calendar=&#39;proleptic_gregorian&#39;, eng=True))</span>
<span class="sd">    1971-04-28 12:30:15</span>

<span class="sd">    History</span>
<span class="sd">    -------</span>
<span class="sd">    Written  Arndt Piayda,   Jun 2010</span>
<span class="sd">    Modified Matthias Cuntz, Feb 2012 - Input can be scalar or array</span>
<span class="sd">                                      - Default: fulldate=True</span>
<span class="sd">                                      - Changed checks for easier extension</span>
<span class="sd">                                      - decimal, decimal360</span>
<span class="sd">             Matthias Cuntz, Jun 2012 - former units keyword is now called refdate</span>
<span class="sd">                                      - units has now original meaning as in netcdftime</span>
<span class="sd">                                      - units=&#39;day as %Y%m%d.%f&#39;</span>
<span class="sd">             Matthias Cuntz, Feb 2013 - solved Excel leap year problem.</span>
<span class="sd">             Matthias Cuntz, Feb 2013 - ported to Python 3</span>
<span class="sd">             Arndt Piayda,   May 2013 - solved eng output problem.</span>
<span class="sd">             Matthias Cuntz, Oct 2013 - Excel starts at 1 not at 0</span>
<span class="sd">             Matthias Cuntz, Oct 2013 - units bugs, e.g. 01.01.0001 was substracted if Julian calendar even with units</span>
<span class="sd">             Matthias Cuntz, May 2016 - units==&#39;month as %Y%m.%f&#39;, units==&#39;year as %Y.%f&#39;</span>
<span class="sd">             Matthias Cuntz, Oct 2016 - netcdftime provided even with netCDF4 &gt; 1.0.0; make leap always integer</span>
<span class="sd">             Matthias Cuntz, May 2020 - numpy docstring format</span>
<span class="sd">             Matthias Cuntz, Jul 2020 - en for eng</span>
<span class="sd">             Matthias Cuntz, Jul 2020 - use proleptic_gregorian for Excel dates</span>
<span class="sd">             Matthias Cuntz, May 2021 - rm np.int and np.float</span>
<span class="sd">                                      - (almost) flake8 compatible</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1"># Constants</span>
    <span class="n">calendars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;gregorian&#39;</span><span class="p">,</span> <span class="s1">&#39;julian&#39;</span><span class="p">,</span> <span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;excel1900&#39;</span><span class="p">,</span> <span class="s1">&#39;excel1904&#39;</span><span class="p">,</span> <span class="s1">&#39;365_day&#39;</span><span class="p">,</span> <span class="s1">&#39;noleap&#39;</span><span class="p">,</span> <span class="s1">&#39;366_day&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;all_leap&#39;</span><span class="p">,</span> <span class="s1">&#39;360_day&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal360&#39;</span><span class="p">]</span>
    <span class="c1">#</span>
    <span class="c1"># Checks</span>
    <span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nt</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">netcdftime</span> <span class="k">as</span> <span class="nn">nt</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;=</span> <span class="s1">&#39;0.9.2&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;360_day&#39;</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;date2dec error: Your version of netcdftime.py is equal&quot;</span>
                    <span class="s2">&quot; or below 0.9.2. The 360_day calendar does not work with&quot;</span>
                    <span class="s2">&quot; arrays here. Please download a newer one.&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">cftime</span> <span class="k">as</span> <span class="nn">nt</span>
    <span class="c1">#</span>
    <span class="n">calendar</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">calendars</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: Wrong calendar! Choose: &quot;</span> <span class="o">+</span>
                         <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">calendars</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">refdate</span> <span class="ow">and</span> <span class="n">units</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: either refdate or units can be given.&quot;</span><span class="p">)</span>
    <span class="c1"># obsolete eng</span>
    <span class="k">if</span> <span class="n">en</span> <span class="ow">and</span> <span class="n">eng</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: &#39;eng&#39; was succeeded by &#39;en&#39;. Only one can be given.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">eng</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">en</span><span class="p">):</span>
        <span class="n">en</span> <span class="o">=</span> <span class="n">eng</span>
    <span class="c1">#</span>
    <span class="c1"># Default</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">yr</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">hr</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">sc</span><span class="p">]))</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">ascii</span> <span class="o">|</span> <span class="n">en</span> <span class="o">|</span> <span class="n">ii</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">fulldate</span><span class="p">)):</span>
        <span class="n">fulldate</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="p">(</span><span class="n">ascii</span> <span class="o">|</span> <span class="n">en</span> <span class="o">|</span> <span class="n">ii</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">fulldate</span><span class="p">)):</span>
        <span class="n">fulldate</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">fulldate</span><span class="p">:</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">mo</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Further checks</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ascii</span><span class="p">,</span> <span class="n">fulldate</span><span class="p">,</span> <span class="n">en</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: Only one of ascii, fulldate, or en can be chosen.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ascii</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="n">ii</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: If ascii, fulldate or en then no special selection yr,mo,dy,hr,mi,sc possible.&quot;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Input size and shape</span>
    <span class="n">islist</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indata</span><span class="p">))</span>
    <span class="n">isarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">islist</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isarr</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: input is list &gt; 2D; Use array input&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">indata</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span>
    <span class="n">insize</span>  <span class="o">=</span> <span class="n">indata</span><span class="o">.</span><span class="n">size</span>
    <span class="n">inshape</span> <span class="o">=</span> <span class="n">indata</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">indata</span>  <span class="o">=</span> <span class="n">indata</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="c1">#</span>
    <span class="c1"># depending on chosen calendar and optional set of the time refdate</span>
    <span class="c1"># calendar date is calculated</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;day as %Y%m</span><span class="si">%d</span><span class="s1">.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">:</span>
        <span class="n">fdy</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">1.</span>  <span class="c1"># day fraction</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">fdy</span>
        <span class="n">day</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">%</span> <span class="mf">100.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">day</span>
        <span class="n">tmp</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">10000.</span>
        <span class="n">month</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">tmp</span> <span class="o">/</span> <span class="mf">100.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">tmp</span>
        <span class="n">year</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">/</span> <span class="mf">10000.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">fdy</span> <span class="o">*</span> <span class="mf">86400.</span><span class="p">)</span>
        <span class="n">hour</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">secs</span> <span class="o">-</span> <span class="mf">3600.</span> <span class="o">*</span> <span class="n">hour</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">60.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">secs</span> <span class="o">-</span> <span class="mf">60.</span> <span class="o">*</span> <span class="n">minute</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;month as %Y%m.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">:</span>
        <span class="n">fmo</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">1.</span>  <span class="c1"># month fraction</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">fmo</span>
        <span class="n">month</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">%</span> <span class="mf">100.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">month</span>
        <span class="n">year</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">/</span> <span class="mf">100.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">leap</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">|</span>
                          <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">dim</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
                            <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span>
                           <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
                            <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[(</span><span class="n">leap</span><span class="p">,</span> <span class="n">month</span><span class="p">)]</span> <span class="o">*</span> <span class="n">fmo</span>
        <span class="n">fdy</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">1.</span>  <span class="c1"># day fraction</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">fdy</span>
        <span class="n">day</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">%</span> <span class="mf">100.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">fdy</span> <span class="o">*</span> <span class="mf">86400.</span><span class="p">)</span>
        <span class="n">hour</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">secs</span> <span class="o">-</span> <span class="mf">3600.</span> <span class="o">*</span> <span class="n">hour</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">60.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">secs</span> <span class="o">-</span> <span class="mf">60.</span> <span class="o">*</span> <span class="n">minute</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;year as %Y.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">:</span>
        <span class="n">fyr</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">1.</span>  <span class="c1"># year fraction</span>
        <span class="n">year</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">-</span> <span class="n">fyr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">leap</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">|</span>
                          <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">dsiy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">365</span><span class="p">,</span> <span class="mi">366</span><span class="p">])</span>
        <span class="n">indata</span> <span class="o">=</span> <span class="n">dsiy</span><span class="p">[</span><span class="n">leap</span><span class="p">]</span> <span class="o">*</span> <span class="n">fyr</span>
        <span class="n">fdy</span>    <span class="o">=</span> <span class="n">indata</span> <span class="o">%</span> <span class="mf">1.</span>  <span class="c1"># day fraction</span>
        <span class="n">doy</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">indata</span> <span class="o">-</span> <span class="n">fdy</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">diy</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span>
                             <span class="mi">212</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">365</span><span class="p">],</span>
                            <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span>
                             <span class="mi">213</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">366</span><span class="p">]</span> <span class="p">])</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">day</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
            <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">doy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">leap</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">:]))[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="n">doy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">diy</span><span class="p">[</span><span class="n">leap</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">fdy</span> <span class="o">*</span> <span class="mf">86400.</span><span class="p">)</span>
        <span class="n">hour</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">secs</span>   <span class="o">=</span> <span class="n">secs</span> <span class="o">-</span> <span class="mf">3600.</span> <span class="o">*</span> <span class="n">hour</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">secs</span> <span class="o">/</span> <span class="mf">60.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">secs</span> <span class="o">-</span> <span class="mf">60.</span> <span class="o">*</span> <span class="n">minute</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;gregorian&#39;</span><span class="p">):</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="c1"># unit = &#39;days since %s&#39; % (refdate)</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 12:00:00&#39;</span>
                <span class="n">dec0</span> <span class="o">=</span> <span class="mi">1721424</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span> <span class="o">-</span> <span class="n">dec0</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;gregorian&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;julian&#39;</span><span class="p">:</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 12:00:00&#39;</span>
                <span class="n">dec0</span> <span class="o">=</span> <span class="mi">1721424</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span> <span class="o">-</span> <span class="n">dec0</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;julian&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;excel1900&#39;</span><span class="p">:</span>
            <span class="n">doerr</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 1899-12-31 00:00:00&#39;</span>
                <span class="k">if</span> <span class="n">excelerr</span><span class="p">:</span>
                    <span class="n">doerr</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">doerr</span><span class="p">:</span>
                <span class="n">indata1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">indata</span> <span class="o">&gt;=</span> <span class="mf">61.</span><span class="p">,</span> <span class="n">indata</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">indata</span><span class="p">)</span>
                <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata1</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span>
                                      <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span>
                                      <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;excel1904&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 1903-12-31 00:00:00&#39;</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;365_day&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;noleap&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;365_day&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;366_day&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;all_leap&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;366_day&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;360_day&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
            <span class="k">elif</span> <span class="n">refdate</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">refdate</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
            <span class="n">timeobj</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">indata</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;decimal&#39;</span><span class="p">:</span>
            <span class="n">fyear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span>
            <span class="n">year</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fyear</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">leap</span>  <span class="o">=</span> <span class="p">((((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">|</span>
                     <span class="p">((</span><span class="n">year</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">fleap</span> <span class="o">=</span> <span class="n">leap</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">fract_date</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">fyear</span>
            <span class="n">days_year</span>  <span class="o">=</span> <span class="mf">365.</span>
            <span class="c1"># date in hours</span>
            <span class="n">fhoy</span>  <span class="o">=</span> <span class="n">fract_date</span> <span class="o">*</span> <span class="p">(</span><span class="n">days_year</span> <span class="o">+</span> <span class="n">fleap</span><span class="p">)</span> <span class="o">*</span> <span class="mf">24.</span>
            <span class="n">fihoy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fhoy</span><span class="p">)</span>
            <span class="n">ihoy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fihoy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># minutes</span>
            <span class="n">fmoy</span>    <span class="o">=</span> <span class="p">(</span><span class="n">fhoy</span> <span class="o">-</span> <span class="n">fihoy</span><span class="p">)</span> <span class="o">*</span> <span class="mf">60.</span>
            <span class="n">fminute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fmoy</span><span class="p">)</span>
            <span class="n">minute</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fminute</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># seconds</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">((</span><span class="n">fmoy</span> <span class="o">-</span> <span class="n">fminute</span><span class="p">)</span> <span class="o">*</span> <span class="mf">60.</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># months</span>
            <span class="n">fdoy</span>  <span class="o">=</span> <span class="p">(</span><span class="n">fihoy</span> <span class="o">/</span> <span class="mf">24.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="n">fidoy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fdoy</span><span class="p">)</span>
            <span class="n">idoy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fidoy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">month</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">diy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span>
                                <span class="mi">212</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">365</span><span class="p">],</span>
                               <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span>
                                <span class="mi">213</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">366</span><span class="p">]</span> <span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
                <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idoy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">leap</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">:])))</span>
                <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># days</span>
            <span class="n">fday</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
                <span class="n">fday</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fdoy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">leap</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
            <span class="n">day</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fday</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># hours</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="n">ihoy</span> <span class="o">%</span> <span class="mi">24</span>
        <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;decimal360&#39;</span><span class="p">:</span>
            <span class="n">fyear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span>
            <span class="n">year</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fyear</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">fract_date</span> <span class="o">=</span> <span class="n">indata</span> <span class="o">-</span> <span class="n">fyear</span>
            <span class="n">days_year</span>  <span class="o">=</span> <span class="mf">360.</span>
            <span class="c1"># date in hours</span>
            <span class="n">fhoy</span>  <span class="o">=</span> <span class="n">fract_date</span> <span class="o">*</span> <span class="n">days_year</span> <span class="o">*</span> <span class="mf">24.</span>
            <span class="n">fihoy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fhoy</span><span class="p">)</span>
            <span class="n">ihoy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fihoy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># minutes</span>
            <span class="n">fmoy</span>    <span class="o">=</span> <span class="p">(</span><span class="n">fhoy</span> <span class="o">-</span> <span class="n">fihoy</span><span class="p">)</span> <span class="o">*</span> <span class="mf">60.</span>
            <span class="n">fminute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fmoy</span><span class="p">)</span>
            <span class="n">minute</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fminute</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># seconds</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">((</span><span class="n">fmoy</span> <span class="o">-</span> <span class="n">fminute</span><span class="p">)</span> <span class="o">*</span> <span class="mf">60.</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># months</span>
            <span class="n">fdoy</span>  <span class="o">=</span> <span class="p">(</span><span class="n">fihoy</span> <span class="o">/</span> <span class="mf">24.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="n">fidoy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fdoy</span><span class="p">)</span>
            <span class="n">idoy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fidoy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">month</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">diy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span>
                               <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">360</span> <span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
                <span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idoy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">diy</span><span class="p">))</span>
                <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># days</span>
            <span class="n">fday</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
                <span class="n">fday</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="n">fdoy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
            <span class="n">day</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fday</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="c1"># hours</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="n">ihoy</span> <span class="o">%</span> <span class="mi">24</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: calendar not implemented; should have been catched before.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal360&#39;</span><span class="p">]):</span>
            <span class="n">timeobjfl</span> <span class="o">=</span> <span class="n">timeobj</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">year</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">year</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">month</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">month</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">day</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">day</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">hour</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hour</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">minute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">minute</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">timeobjfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">second</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;excel1900&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">excelerr</span><span class="p">:</span>
                <span class="n">ii</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">indata</span> <span class="o">&gt;=</span> <span class="mf">60.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">indata</span> <span class="o">&lt;</span> <span class="mf">61.</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">month</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                    <span class="n">day</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>   <span class="o">=</span> <span class="mi">29</span>
    <span class="c1">#</span>
    <span class="c1"># Ascii output</span>
    <span class="k">if</span> <span class="n">ascii</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">.</span><span class="si">%02d</span><span class="s1">.</span><span class="si">%04d</span><span class="s1"> </span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span>
                   <span class="p">(</span><span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hour</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">minute</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Ascii english output</span>
    <span class="k">elif</span> <span class="n">en</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%04d</span><span class="s1">-</span><span class="si">%02d</span><span class="s1">-</span><span class="si">%02d</span><span class="s1"> </span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hour</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">minute</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">second</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Individual output</span>
        <span class="c1"># if one, some or all of yr, mo, dy, hr, mi or sc is</span>
        <span class="c1"># choosen by the user as output, arrays for datetime</span>
        <span class="n">year</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="n">month</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">month</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="n">day</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">day</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="n">hour</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">hour</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">minute</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">inshape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">year</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
            <span class="n">month</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
            <span class="n">day</span>    <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
            <span class="n">hour</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hour</span><span class="p">)</span>
            <span class="n">minute</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">minute</span><span class="p">)</span>
            <span class="n">second</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">second</span><span class="p">)</span>
        <span class="c1"># filling of output list:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">yr</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">year</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mo</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">month</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dy</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">day</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">hr</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">hour</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mi</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">minute</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sc</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">second</span><span class="p">]</span>
        <span class="c1"># return output arrays:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">isarr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">islist</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">inshape</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">loutput</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])):</span>
                    <span class="n">loutput</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]))</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">loutput</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dec2date error: list output &gt; 2D; should have been catched before.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">NORMALIZE_WHITESPACE</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../contents.html">hesseflux</a></h1>



<p class="blurb">Functions used in the processing and post-processing of Eddy covariance flux data</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userguide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package.html">API</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/mcuntz/hesseflux">hesseflux @ GitHub</a></li>
    
    <li class="toctree-l1"><a href="https://doi.org/10.5281/zenodo.3831488">hesseflux @ Zenodo</a></li>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/hesseflux/">hesseflux @ PyPI</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2022, Matthias Cuntz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>