
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hesseflux.date2dec &#8212; hesseflux 3.2.2.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for hesseflux.date2dec</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">date2dec : Converts calendar dates into decimal dates.</span>

<span class="sd">This module was written by Arndt Piayda and then enhanced and</span>
<span class="sd">maintained by Matthias Cuntz while at Department of Computational</span>
<span class="sd">Hydrosystems, Helmholtz Centre for Environmental Research - UFZ,</span>
<span class="sd">Leipzig, Germany, and continued by Matthias Cuntz while at Institut</span>
<span class="sd">National de Recherche pour l&#39;Agriculture, l&#39;Alimentation et</span>
<span class="sd">l&#39;Environnement (INRAE), Nancy, France.</span>

<span class="sd">Copyright (c) 2010-2020 Matthias Cuntz - mc (at) macu (dot) de</span>
<span class="sd">Released under the MIT License; see LICENSE file for details.</span>

<span class="sd">* Written Jun 2010 by Arndt Piayda</span>
<span class="sd">* Input can be scalar, list, array, or mix of it, Feb 2012, Matthias Cuntz</span>
<span class="sd">* Changed checks, added calendars decimal and decimal360, Feb 2012, Matthias Cuntz</span>
<span class="sd">* Changed units of proleptic_gregorian calendar from days since 0001-01-01 00:00:00 to days since 0001-01-00 00:00:00, Dec 2010, Matthias Cuntz</span>
<span class="sd">* Deal with Excel leap year error, Feb 2013, Matthias Cuntz</span>
<span class="sd">* Ported to Python 3, Feb 2013, Matthias Cuntz</span>
<span class="sd">* ascii/eng without time defaults to 00:00:00, Jul 2013, Matthias Cuntz</span>
<span class="sd">* Excel starts at 1 not at 0 on 01 January 1900 or 1904, Oct 2013, Matthias Cuntz</span>
<span class="sd">* Bug: 01.01.0001 was substracted if Julian calendar even with units given, Oct 2013, Matthias Cuntz</span>
<span class="sd">* Removed remnant of time treatment before time check in eng keyword, Nov 2013, Matthias Cuntz</span>
<span class="sd">* Adapted to new netCDF4/netcdftime (&gt;= v1.0) and datetime (&gt;= Python v2.7.9), Jun 2015, Matthias Cuntz</span>
<span class="sd">* Call date2num with list instead of single netCDF4.datetime objects, Oct 2015, Matthias Cuntz</span>
<span class="sd">* mo for months always integer, Oct 2016, Matthias Cuntz</span>
<span class="sd">* 00, 01, etc. for integers not accepted by Python 3, removed from examples and code, Nov 2016, Matthias Cuntz</span>
<span class="sd">* Using numpy docstring format, May 2020, Matthias Cuntz</span>
<span class="sd">* Succeed eng by en keyword as in ascii2ascii and dec2date, Jul 2020, Matthias Cuntz</span>
<span class="sd">* proleptic_gregorian instead of gregorian calendar for Excel dates, Jul 2020, Matthias Cuntz</span>

<span class="sd">.. moduleauthor:: Matthias Cuntz, Arndt Piayda</span>

<span class="sd">The following functions are provided</span>

<span class="sd">.. autosummary::</span>
<span class="sd">   date2dec</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date2dec&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="date2dec"><a class="viewcode-back" href="../../date2dec.html#hesseflux.date2dec.date2dec">[docs]</a><span class="k">def</span> <span class="nf">date2dec</span><span class="p">(</span><span class="n">calendar</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">excelerr</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">yr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">mo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mi</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">ascii</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">en</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eng</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert scalar and array_like with calendar dates into decimal</span>
<span class="sd">    dates. Supported calendar formats are standard, gregorian, julian,</span>
<span class="sd">    proleptic_gregorian, excel1900, excel1904, 365_day, noleap, 366_day,</span>
<span class="sd">    all_leap, 360_day, decimal, or decimal360.</span>

<span class="sd">    Input is year, month day, hour, minute, second or a combination of them.</span>
<span class="sd">    Input as date string is possible.</span>

<span class="sd">    Output is decimal date with day as unit.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    yr : array_like, optional</span>
<span class="sd">        years (default: 1)</span>
<span class="sd">    mo : array_like, optional</span>
<span class="sd">        month (default: 1)</span>
<span class="sd">    dy : array_like, optional</span>
<span class="sd">        days (default: 1)</span>
<span class="sd">    hr : array_like, optional</span>
<span class="sd">        hours (default: 0)</span>
<span class="sd">    mi : array_like, optional</span>
<span class="sd">        minutes (default: 0)</span>
<span class="sd">    sc : array_like, optional</span>
<span class="sd">        seconds (default: 0)</span>
<span class="sd">    ascii : array_like, optional</span>
<span class="sd">        strings of the format &#39;dd.mm.yyyy hh:mm:ss&#39;.</span>
<span class="sd">        Missing hour, minutes and/or seconds are set</span>
<span class="sd">        to their default values (0).</span>

<span class="sd">        `ascii` overwrites all other keywords.</span>

<span class="sd">        `ascii` and `eng` are mutually exclusive.</span>
<span class="sd">    en : array_like, optional</span>
<span class="sd">        strings of the format &#39;yyyy-mm-dd hh:mm:ss&#39;.</span>
<span class="sd">        Missing hour, minutes and/or seconds are set</span>
<span class="sd">        to their default values (0).</span>

<span class="sd">        `en` overwrites all other keywords.</span>

<span class="sd">        `en` and `ascii` are mutually exclusive.</span>
<span class="sd">    eng : array_like, optional</span>
<span class="sd">        Same as en: obsolete.</span>
<span class="sd">    calendar : str, optional</span>
<span class="sd">        Calendar of output dates (default: &#39;standard&#39;).</span>

<span class="sd">        Possible values are:</span>

<span class="sd">        &#39;standard&#39;, &#39;gregorian&#39; = julian calendar from</span>
<span class="sd">        01.01.-4712 12:00:00 (BC) until 05.03.1583 00:00:00 and</span>
<span class="sd">        gregorian calendar from 15.03.1583 00:00:00 until now.</span>
<span class="sd">        Missing 10 days do not exsist.</span>

<span class="sd">        &#39;julian&#39; = julian calendar from 01.01.-4712 12:00:00 (BC)</span>
<span class="sd">         until now.</span>

<span class="sd">        &#39;proleptic_gregorian&#39; = gregorian calendar from</span>
<span class="sd">        01.01.0001 00:00:00 until now.</span>

<span class="sd">        &#39;excel1900&#39; = Excel dates with origin at</span>
<span class="sd">        01.01.1900 00:00:00.</span>

<span class="sd">        &#39;excel1904&#39; = Excel 1904 (Lotus) format.</span>
<span class="sd">        Same as excel1904 but with origin at</span>
<span class="sd">        01.01.1904 00:00:00.</span>

<span class="sd">        &#39;365_day&#39;, &#39;noleap&#39; = 365 days format,</span>
<span class="sd">        i.e. common years only (no leap years)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;366_day&#39;, &#39;all_leap&#39; = 366 days format,</span>
<span class="sd">        i.e. leap years only (no common years)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;360_day&#39; = 360 days format,</span>
<span class="sd">        i.e. years with only 360 days (30 days per month)</span>
<span class="sd">        with origin at 01.01.0001 00:00:00.</span>

<span class="sd">        &#39;decimal&#39; = decimal year instead of decimal days.</span>

<span class="sd">        &#39;decimal360&#39; = decimal year with a year of 360 days, i.e. 12 month with 30 days each.</span>
<span class="sd">    units : str, optional</span>
<span class="sd">        User set units of output dates. Must be a</span>
<span class="sd">        string in the format &#39;days since yyyy-mm-dd hh:mm:ss&#39;.</span>
<span class="sd">        Default values are set automatically depending on `calendar`.</span>
<span class="sd">    excelerr : bool, optional</span>
<span class="sd">       In Excel, the year 1900 is normally considered a leap year,</span>
<span class="sd">       which it was not. By default, this error is taken into account</span>
<span class="sd">       if `calendar==&#39;excel1900&#39;` (default: True).</span>

<span class="sd">       1900 is not considered a leap year if `excelerr==False`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array_like</span>
<span class="sd">       array_like with decimal dates. The type of output will be the same as the input type.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Most versions of `datetime` do not support negative years,</span>
<span class="sd">    i.e. Julian days &lt; 1721423.5 = 01.01.0001 00:00:00.</span>

<span class="sd">    There is an issue in `netcdftime` version &lt; 0.9.5 in proleptic_gregorian for dates before year 301:</span>
<span class="sd">    dec2date(date2dec(ascii=&#39;01.01.0300 00:00:00&#39;, calendar=&#39;proleptic_gregorian&#39;), calendar=&#39;proleptic_gregorian&#39;)</span>
<span class="sd">    [300, 1, 2, 0, 0, 0]</span>
<span class="sd">    dec2date(date2dec(ascii=&#39;01.01.0301 00:00:00&#39;, calendar=&#39;proleptic_gregorian&#39;), calendar=&#39;proleptic_gregorian&#39;)</span>
<span class="sd">    [301, 1, 1, 0, 0, 0]</span>

<span class="sd">    List input is only supported up to 2 dimensions.</span>

<span class="sd">    Requires `netcdftime.py` from module `netcdftime` available at:</span>
<span class="sd">    http://netcdf4-python.googlecode.com</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    # Some implementations of datetime do not support negative years</span>
<span class="sd">    &gt;&gt;&gt; import datetime</span>
<span class="sd">    &gt;&gt;&gt; if datetime.MINYEAR &gt; 0:</span>
<span class="sd">    ...     print(&#39;The minimum year in your datetime implementation is &#39;, datetime.MINYEAR)</span>
<span class="sd">    ...     print(&#39;i.e. it does not support negative years (BC).&#39;)</span>
<span class="sd">    The minimum year in your datetime implementation is  1</span>
<span class="sd">    i.e. it does not support negative years (BC).</span>

<span class="sd">    &gt;&gt;&gt; if datetime.MINYEAR &gt; 0:</span>
<span class="sd">    ...     year   = np.array([2000, 1810, 1630, 1510, 1271, 619, 2, 1])</span>
<span class="sd">    ... else:</span>
<span class="sd">    ...     year   = np.array([2000, 1810, 1630, 1510, 1271, 619, -1579, -4712])</span>
<span class="sd">    &gt;&gt;&gt; month  = np.array([1, 4, 7, 9, 3, 8, 8, 1])</span>
<span class="sd">    &gt;&gt;&gt; day    = np.array([5, 24, 15, 20, 18, 27, 23, 1])</span>
<span class="sd">    &gt;&gt;&gt; hour   = np.array([12, 16, 10, 14, 19, 11, 20, 12])</span>
<span class="sd">    &gt;&gt;&gt; minute = np.array([30, 15, 20, 35, 41, 8, 3, 0])</span>
<span class="sd">    &gt;&gt;&gt; second = np.array([15, 10, 40, 50, 34, 37, 41, 0])</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar = &#39;standard&#39;, yr=year, mo=month, dy=day, hr=hour, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; nn = year.size</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e} {:.14e} {:.14e}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    2.45154902100695e+06 2.38226217719907e+06 2.31660093101852e+06 2.27284810821759e+06</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e}&#39;.format(*decimal[nn//2:nn-2]))</span>
<span class="sd">    2.18536732053241e+06 1.94738596431713e+06</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;standard&#39;, yr=year, mo=6, dy=15, hr=12, mi=minute, sc=second)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e} {:.14e} {:.14e}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    2.45171102100695e+06 2.38231401053241e+06 2.31657101435185e+06 2.27275102488426e+06</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e}&#39;.format(*decimal[nn//2:nn-2]))</span>
<span class="sd">    2.18545602886574e+06 1.94731300598380e+06</span>

<span class="sd">    # ascii input</span>
<span class="sd">    &gt;&gt;&gt; if datetime.MINYEAR &gt; 0:</span>
<span class="sd">    ...     a = np.array([&#39;05.01.2000 12:30:15&#39;, &#39;24.04.1810 16:15:10&#39;, &#39;15.07.1630 10:20:40&#39;, &#39;20.09.1510 14:35:50&#39;,</span>
<span class="sd">    ...                   &#39;18.03.1271 19:41:34&#39;, &#39;27.08. 619 11:08:37&#39;, &#39;23.08.0002 20:03:41&#39;, &#39;01.01.0001 12:00:00&#39;])</span>
<span class="sd">    ... else:</span>
<span class="sd">    ...     a = np.array([&#39;05.01.2000 12:30:15&#39;, &#39;24.04.1810 16:15:10&#39;, &#39;15.07.1630 10:20:40&#39;,  &#39;20.09.1510 14:35:50&#39;,</span>
<span class="sd">    ...                   &#39;18.03.1271 19:41:34&#39;, &#39;27.08. 619 11:08:37&#39;, &#39;23.08.-1579 20:03:41&#39;, &#39;01.01.-4712 12:00:00&#39;])</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;standard&#39;, ascii=a)</span>
<span class="sd">    &gt;&gt;&gt; nn = a.size</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e} {:.14e} {:.14e}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    2.45154902100695e+06 2.38226217719907e+06 2.31660093101852e+06 2.27284810821759e+06</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e}&#39;.format(*decimal[nn//2:nn-2]))</span>
<span class="sd">    2.18536732053241e+06 1.94738596431713e+06</span>

<span class="sd">    # calendar = &#39;julian&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;julian&#39;, ascii=a)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e} {:.14e} {:.14e}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    2.45156202100695e+06 2.38227417719907e+06 2.31661093101852e+06 2.27284810821759e+06</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.14e} {:.14e}&#39;.format(*decimal[nn//2:nn-2]))</span>
<span class="sd">    2.18536732053241e+06 1.94738596431713e+06</span>

<span class="sd">    # calendar = &#39;proleptic_gregorian&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;proleptic_gregorian&#39;, ascii=a)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    730123.5210069 660836.6771991 595175.4310185 551412.6082176</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*decimal[nn//2:nn-2]))</span>
<span class="sd">    463934.8205324 225957.4643171</span>

<span class="sd">    # calendar = &#39;excel1900&#39; WITH excelerr=True -&gt; 1900 considered as leap year</span>
<span class="sd">    &gt;&gt;&gt; d = np.array([&#39;05.01.2000 12:30:15&#39;, &#39;27.05.1950 16:25:10&#39;, &#39;13.08.1910 10:40:55&#39;,</span>
<span class="sd">    ...               &#39;01.03.1900 00:00:00&#39;, &#39;29.02.1900 00:00:00&#39;, &#39;28.02.1900 00:00:00&#39;,</span>
<span class="sd">    ...               &#39;01.01.1900 00:00:00&#39;])</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;, ascii=d)</span>
<span class="sd">    &gt;&gt;&gt; nn = d.size</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    36530.5210069 18410.6841435 3878.4450810</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.1f} {:.1f} {:.1f} {:.1f}&#39;.format(*decimal[nn//2:]))</span>
<span class="sd">    61.0 60.0 59.0 1.0</span>

<span class="sd">    # calendar = &#39;excel1900&#39; WITH excelerr = False -&gt; 1900 is NO leap year</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1900&#39;, ascii=d, excelerr=False)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    36529.5210069 18409.6841435 3877.4450810</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.1f} {:.1f} {:.1f} {:.1f}&#39;.format(*decimal[nn//2:]))</span>
<span class="sd">    60.0 60.0 59.0 1.0</span>

<span class="sd">    # calendar = &#39;excel1904&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;excel1904&#39;, ascii=d[:nn//2])</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn//2]))</span>
<span class="sd">    35069.5210069 16949.6841435 2417.4450810</span>

<span class="sd">    # calendar = &#39;365_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; g = np.array([&#39;18.08.1972 12:30:15&#39;, &#39;25.10.0986 12:30:15&#39;, &#39;28.11.0493 22:20:40&#39;, &#39;01.01.0001 00:00:00&#39;])</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;365_day&#39;, ascii=g)</span>
<span class="sd">    &gt;&gt;&gt; nn = g.size</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn]))</span>
<span class="sd">    719644.5210069 359822.5210069 179911.9310185 0.0000000</span>

<span class="sd">    # calendar = &#39;366_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;366_day&#39;, ascii=g)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn]))</span>
<span class="sd">    721616.5210069 360808.5210069 180404.9310185 0.0000000</span>

<span class="sd">    # 360_day does not work with netcdftime.py version equal or below 0.9.2</span>
<span class="sd">    # calendar = &#39;360_day&#39;</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(calendar=&#39;360_day&#39;, ascii=g)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f} {:.7f} {:.7f}&#39;.format(*decimal[:nn]))</span>
<span class="sd">    709787.5210069 354894.5210069 177447.9310185 0.0000000</span>

<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f}&#39;.format(date2dec(yr=1992, mo=1, dy=26, hr=2, mi=0, sc=0, calendar=&#39;decimal&#39;)))</span>
<span class="sd">    1992.0685337</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f}&#39;.format(date2dec(ascii=&#39;26.01.1992 02:00&#39;, calendar=&#39;decimal360&#39;)))</span>
<span class="sd">    1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*date2dec(ascii=[&#39;26.01.1992 02:00&#39;,&#39;26.01.1992 02:00&#39;], calendar=&#39;decimal360&#39;)))</span>
<span class="sd">    1992.0696759 1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*date2dec(yr=[1992,1992], mo=1, dy=26, hr=2, mi=0, sc=0, calendar=&#39;decimal360&#39;)))</span>
<span class="sd">    1992.0696759 1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*date2dec(yr=np.array([1992,1992]), mo=1, dy=26, hr=2, mi=0, sc=0, calendar=&#39;decimal360&#39;)))</span>
<span class="sd">    1992.0696759 1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(ascii=[[&#39;26.01.1992 02:00&#39;,&#39;26.01.1992 02:00&#39;],</span>
<span class="sd">    ...                           [&#39;26.01.1992 02:00&#39;,&#39;26.01.1992 02:00&#39;],</span>
<span class="sd">    ...                           [&#39;26.01.1992 02:00&#39;,&#39;26.01.1992 02:00&#39;]],</span>
<span class="sd">    ...                    calendar=&#39;decimal360&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*decimal[0]))</span>
<span class="sd">    1992.0696759 1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f} {:.7f}&#39;.format(*decimal[2]))</span>
<span class="sd">    1992.0696759 1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; print((date2dec(ascii=&#39;01.03.2003 00:00:00&#39;) - date2dec(ascii=&#39;01.03.2003&#39;)) == 0.)</span>
<span class="sd">    True</span>

<span class="sd">    # en</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(en=&#39;1992-01-26 02:00&#39;, calendar=&#39;decimal360&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f}&#39;.format(decimal))</span>
<span class="sd">    1992.0696759</span>
<span class="sd">    &gt;&gt;&gt; decimal = date2dec(eng=&#39;1992-01-26 02:00&#39;, calendar=&#39;decimal360&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;{:.7f}&#39;.format(decimal))</span>
<span class="sd">    1992.0696759</span>

<span class="sd">    History</span>
<span class="sd">    -------</span>
<span class="sd">    Written  Arndt Piayda, Jun 2010</span>
<span class="sd">    Modified Matthias Cuntz, Feb 2012 - All input can be scalar, list or array, also a mix</span>
<span class="sd">                                        - Changed checks for easier extension</span>
<span class="sd">                                        - decimal, decimal360</span>
<span class="sd">             Matthias Cuntz, Dec 2012 - change unit of proleptic_gregorian</span>
<span class="sd">                                        from &#39;days since 0001-01-01 00:00:00&#39;</span>
<span class="sd">                                        to   &#39;days since 0001-01-00 00:00:00&#39;</span>
<span class="sd">             Matthias Cuntz, Feb 2013 - solved Excel leap year problem.</span>
<span class="sd">             Matthias Cuntz, Feb 2013 - ported to Python 3</span>
<span class="sd">             Matthias Cuntz, Jul 2013 - ascii/eng without time defaults to 00:00:00</span>
<span class="sd">             Matthias Cuntz, Oct 2013 - Excel starts at 1 not at 0</span>
<span class="sd">             Matthias Cuntz, Oct 2013 - units bugs, e.g. 01.01.0001 was substracted if Julian calendar even with units</span>
<span class="sd">             Matthias Cuntz, Nov 2013 - removed remnant of time treatment before time check in eng keyword</span>
<span class="sd">             Matthias Cuntz, Jun 2015 - adapted to new netCDF4/netcdftime (&gt;= v1.0) and datetime (&gt;= Python v2.7.9)</span>
<span class="sd">             Matthias Cuntz, Oct 2015 - call date2num with list instead of single netCDF4.datetime objects</span>
<span class="sd">             Matthias Cuntz, Oct 2016 - netcdftime provided even with netCDF4 &gt; 1.0.0; make mo for months always integer</span>
<span class="sd">             Matthias Cuntz, Nov 2016 - 00, 01, etc. for integers not accepted by Python3</span>
<span class="sd">             Matthias Cuntz, May 2020 - numpy docstring format</span>
<span class="sd">             Matthias Cuntz, Jul 2020 - en for eng</span>
<span class="sd">             Matthias Cuntz, Jul 2020 - use proleptic_gregorian for Excel dates</span>
<span class="sd">             Matthias Cuntz, May 2021 - rm np.int and np.float</span>
<span class="sd">                                      - (almost) flake8 compatible</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1"># Checks</span>
    <span class="n">calendars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;gregorian&#39;</span><span class="p">,</span> <span class="s1">&#39;julian&#39;</span><span class="p">,</span> <span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;excel1900&#39;</span><span class="p">,</span> <span class="s1">&#39;excel1904&#39;</span><span class="p">,</span> <span class="s1">&#39;365_day&#39;</span><span class="p">,</span> <span class="s1">&#39;noleap&#39;</span><span class="p">,</span> <span class="s1">&#39;366_day&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;all_leap&#39;</span><span class="p">,</span> <span class="s1">&#39;360_day&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal360&#39;</span><span class="p">]</span>
    <span class="c1"># add little epsilon to julian dates for better reconversion</span>
    <span class="n">muleps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">cftime</span> <span class="k">as</span> <span class="nn">nt</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;=</span> <span class="s1">&#39;1.0.4&#39;</span><span class="p">):</span>
            <span class="n">muleps</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># before 1.0.5, cftime used eps</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nt</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">netcdftime</span> <span class="k">as</span> <span class="nn">nt</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;=</span> <span class="s1">&#39;0.9.2&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;360_day&#39;</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;date2dec error: Your version of netcdftime.py is equal&quot;</span>
                    <span class="s2">&quot; or below 0.9.2. The 360_day calendar does not work with&quot;</span>
                    <span class="s2">&quot; arrays here. Please download a newer one.&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Could not determine netcdf time library.&#39;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">calendar</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">calendars</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;date2dec error: Wrong calendar!&quot;</span> <span class="o">+</span>
            <span class="s2">&quot; Choose: &quot;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">calendars</span><span class="p">]))</span>
    <span class="c1"># obsolete eng</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">eng</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">en</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: &#39;eng&#39; was succeeded by &#39;en&#39;. Only one can be given.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">en</span> <span class="o">=</span> <span class="n">eng</span>
    <span class="c1"># if ascii input is given by user, other input will be neglected</span>
    <span class="c1"># calculation of input size and shape</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ascii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">en</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: &#39;ascii&#39; and &#39;en&#39; mutually exclusive&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ascii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">islist</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">ascii</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ascii</span><span class="p">))</span>
        <span class="n">isarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">ascii</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">islist</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isarr</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: ascii input is list &gt; 2D; Use array input&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ascii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ascii</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ascii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ascii</span><span class="p">)</span>
        <span class="n">insize</span>   <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">size</span>
        <span class="n">outsize</span>  <span class="o">=</span> <span class="n">insize</span>
        <span class="n">outshape</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">asciifl</span>  <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">timeobj</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="c1"># slicing of ascii strings to implement in datetime object. missing times</span>
        <span class="c1"># will be set to 0.</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
            <span class="n">aa</span>      <span class="o">=</span> <span class="n">asciifl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tail</span>    <span class="o">=</span> <span class="n">aa</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tail</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tim</span>     <span class="o">=</span> <span class="n">tail</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1900</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)):</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                         <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">en</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">islist</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">en</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">en</span><span class="p">))</span>
        <span class="n">isarr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">en</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">islist</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isarr</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: en input is list &gt; 2D; Use array input&quot;</span><span class="p">)</span>
        <span class="n">en</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
        <span class="n">insize</span>   <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">size</span>
        <span class="n">outsize</span>  <span class="o">=</span> <span class="n">insize</span>
        <span class="n">outshape</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">enfl</span>     <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">timeobj</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="c1"># slicing of en strings to implement in datetime object. missing times</span>
        <span class="c1"># will be set to 0.</span>
        <span class="n">yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">insize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">insize</span><span class="p">):</span>
            <span class="n">ee</span>      <span class="o">=</span> <span class="n">enfl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ee</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">tail</span>    <span class="o">=</span> <span class="n">ee</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tail</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tim</span>     <span class="o">=</span> <span class="n">tail</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tim</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tim</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1900</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)):</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                         <span class="n">sc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c1"># if no ascii input, other inputs will be concidered</span>
    <span class="c1"># calculation of input sizes, shapes and number of axis</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ascii</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">en</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">isnlist1</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yr</span><span class="p">))</span>
        <span class="n">isarr1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">yr</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
        <span class="n">isnlist2</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mo</span><span class="p">))</span>
        <span class="n">isarr2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mo</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mo</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">isnlist3</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">))</span>
        <span class="n">isarr3</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dy</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
        <span class="n">isnlist4</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hr</span><span class="p">))</span>
        <span class="n">isarr4</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">hr</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>
        <span class="n">isnlist5</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mi</span><span class="p">))</span>
        <span class="n">isarr5</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mi</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
        <span class="n">isnlist6</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
        <span class="n">isarr6</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isarr6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sc</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
        <span class="n">islist</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">isnlist1</span> <span class="o">|</span> <span class="n">isnlist2</span> <span class="o">|</span> <span class="n">isnlist3</span> <span class="o">|</span> <span class="n">isnlist4</span> <span class="o">|</span> <span class="n">isnlist5</span> <span class="o">|</span>
                      <span class="n">isnlist6</span><span class="p">)</span>
        <span class="n">isarr</span>  <span class="o">=</span> <span class="n">isarr1</span> <span class="o">+</span> <span class="n">isarr2</span> <span class="o">+</span> <span class="n">isarr3</span> <span class="o">+</span> <span class="n">isarr4</span> <span class="o">+</span> <span class="n">isarr5</span> <span class="o">+</span> <span class="n">isarr6</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mo</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dy</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">hr</span><span class="p">),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">sc</span><span class="p">)]</span>
        <span class="n">nyr</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
        <span class="n">nmo</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span>
        <span class="n">ndy</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
        <span class="n">nhr</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span>
        <span class="n">nmi</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
        <span class="n">nsc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
        <span class="n">sizes</span>  <span class="o">=</span> <span class="p">[</span><span class="n">nyr</span><span class="p">,</span> <span class="n">nmo</span><span class="p">,</span> <span class="n">ndy</span><span class="p">,</span> <span class="n">nhr</span><span class="p">,</span> <span class="n">nmi</span><span class="p">,</span> <span class="n">nsc</span><span class="p">]</span>
        <span class="n">nmax</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="n">ii</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="n">outshape</span> <span class="o">=</span> <span class="n">shapes</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">islist</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">outshape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: input is list &gt; 2D; Use array input.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nyr</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nyr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">yr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">yr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of yr != max input or 1.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nmo</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nmo</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mo</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">mo</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of mo != max input or 1.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ndy</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ndy</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">dy</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of dy != max input or 1.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nhr</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nhr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">hr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">hr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of hr != max input or 1.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nmi</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nmi</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">mi</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">mi</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of mi != max input or 1.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nsc</span> <span class="o">&lt;</span> <span class="n">nmax</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nsc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">sc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">outshape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">sc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: size of sc != max input or 1.&quot;</span><span class="p">)</span>
        <span class="n">indate</span>  <span class="o">=</span> <span class="p">[</span><span class="n">yr</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">hr</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">sc</span><span class="p">]</span>
        <span class="n">insize</span>  <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indate</span><span class="p">]</span>
        <span class="n">inshape</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indate</span><span class="p">]</span>
        <span class="n">dimnum</span>  <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inshape</span><span class="p">]</span>
        <span class="c1"># calculation of maximum input size and maximum number of axis for</span>
        <span class="c1"># reshaping the output</span>
        <span class="n">indate</span>  <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indate</span><span class="p">]</span>
        <span class="n">outsize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">insize</span><span class="p">)</span>
        <span class="n">timeobj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">outsize</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="c1"># datetime object is constructed</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">outsize</span><span class="p">):</span>
            <span class="n">iyr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">imo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">idy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ihr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">imi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="n">isc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">indate</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">iyr</span> <span class="o">==</span> <span class="mi">1900</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">imo</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">idy</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)):</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">iyr</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ihr</span><span class="p">,</span> <span class="n">imi</span><span class="p">,</span> <span class="n">isc</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timeobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">iyr</span><span class="p">,</span> <span class="n">imo</span><span class="p">,</span> <span class="n">idy</span><span class="p">,</span> <span class="n">ihr</span><span class="p">,</span> <span class="n">imi</span><span class="p">,</span> <span class="n">isc</span><span class="p">)</span>
    <span class="c1"># depending on chosen calendar and optional set of the time units</span>
    <span class="c1"># decimal date is calculated</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">outsize</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">)</span>
    <span class="n">t1</span>    <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">is121</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">timeobj</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">t0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">timeobj</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">t1</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;gregorian&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 12:00:00&#39;</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">1721424</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                         <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;gregorian&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">dec0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;gregorian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span> <span class="n">dec0</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;julian&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 12:00:00&#39;</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">1721424</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dec0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                         <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;julian&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">dec0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;julian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span> <span class="n">dec0</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                         <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;excel1900&#39;</span><span class="p">:</span>
        <span class="n">doerr</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 1899-12-31 00:00:00&#39;</span>
            <span class="k">if</span> <span class="n">excelerr</span><span class="p">:</span>
                <span class="n">doerr</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                         <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doerr</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">output</span> <span class="o">&gt;=</span> <span class="mf">60.</span><span class="p">,</span> <span class="n">output</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
            <span class="c1"># date2num treats 29.02.1900 as 01.03.1990,</span>
            <span class="c1"># i.e. is the same decimal number</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">output</span> <span class="o">&gt;=</span> <span class="mf">61.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">output</span> <span class="o">&lt;</span> <span class="mf">62.</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">outsize</span><span class="p">):</span>
                    <span class="c1"># if (timeobj[i].year==1900) &amp; (timeobj[i].month==2) &amp;</span>
                    <span class="c1">#    (timeobj[i].day==29):</span>
                    <span class="c1">#     output[i] -= 1.</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">yr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1900</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">29</span><span class="p">):</span>
                        <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">1.</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;excel1904&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 1903-12-31 00:00:00&#39;</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                         <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;365_day&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;noleap&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;365_day&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;365_day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;366_day&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;all_leap&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;366_day&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;366_day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;360_day&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;days since 0001-01-01 00:00:00&#39;</span>
        <span class="k">if</span> <span class="n">is121</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nt</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;1.2.2&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">timeobj</span><span class="p">):</span>
                <span class="n">output</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">nt</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">timeobj</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span>
                                 <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;360_day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">*</span> <span class="n">muleps</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;decimal&#39;</span><span class="p">:</span>
        <span class="n">ntime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
        <span class="n">leap</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((((</span><span class="n">yr</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">yr</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span> <span class="o">|</span>
                         <span class="p">((</span><span class="n">yr</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">tdy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">diy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span>  <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span>
                            <span class="mi">243</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">365</span><span class="p">],</span>
                           <span class="p">[</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span>  <span class="mi">91</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span>
                            <span class="mi">244</span><span class="p">,</span> <span class="mi">274</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">366</span><span class="p">]</span> <span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntime</span><span class="p">):</span>
            <span class="n">tdy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">leap</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">days_year</span> <span class="o">=</span> <span class="mf">365.</span>
        <span class="n">output</span>    <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span>
                      <span class="p">((</span><span class="n">tdy</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="mf">24.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span> <span class="o">+</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span> <span class="o">/</span>
                      <span class="p">((</span><span class="n">days_year</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">leap</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span> <span class="o">*</span> <span class="mf">24.</span><span class="p">)</span> <span class="p">)</span>
        <span class="c1"># for numerical stability, i.e. back and forth transforms</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="mf">1e-08</span>  <span class="c1"># 1/3 sec</span>
    <span class="k">elif</span> <span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;decimal360&#39;</span><span class="p">:</span>
        <span class="n">ntime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
        <span class="n">tdy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">diy</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span>
                          <span class="mi">300</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntime</span><span class="p">):</span>
            <span class="n">tdy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tdy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">diy</span><span class="p">[</span><span class="n">mo</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">days_year</span> <span class="o">=</span> <span class="mf">360.</span>
        <span class="n">output</span>    <span class="o">=</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span>
                      <span class="p">((</span><span class="n">tdy</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="mf">24.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">+</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span> <span class="o">+</span>
                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3600.</span><span class="p">)</span> <span class="o">/</span>
                      <span class="p">(</span><span class="n">days_year</span> <span class="o">*</span> <span class="mf">24.</span><span class="p">)</span> <span class="p">)</span>
        <span class="c1"># for numerical stability, i.e. back and forth transforms</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="mf">1e-08</span>  <span class="c1"># 1/3 sec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;date2dec error: calendar not implemented; should have been catched before.&quot;</span><span class="p">)</span>

    <span class="c1"># return of reshaped output</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">outshape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">isarr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">islist</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">outshape</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ns</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loutput</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">output</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])):</span>
                    <span class="n">loutput</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]))</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">loutput</span>

    <span class="k">return</span> <span class="n">output</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">NORMALIZE_WHITESPACE</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../contents.html">hesseflux</a></h1>



<p class="blurb">Functions used in the processing and post-processing of Eddy covariance flux data</p>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">hesseflux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userguide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Authors</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/mcuntz/hesseflux">hesseflux @ GitHub</a></li>
    
    <li class="toctree-l1"><a href="https://doi.org/10.5281/zenodo.3831488">hesseflux @ Zenodo</a></li>
    
    <li class="toctree-l1"><a href="https://pypi.org/project/hesseflux/">hesseflux @ PyPI</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2022, Matthias Cuntz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>